import{b as y,c as p}from"./helper.25ee44c6.js";function u(s){const d=document.querySelector("#__errorWrapper__"),r=document.querySelector("#__errorWrapper__ .content");s===-1?(d.style.display="none",r.innerText=""):(d.style.display="block",r.innerText=s)}function S(s){return new Promise((d,r)=>{var t;const e=document.createElement("link");p(e,{ref:"stylesheet",href:s}),(t=document.querySelector("head"))==null||t.appendChild(e),e.onload=()=>{d(1)},e.onerror=n=>{r(n)}})}function _(s){return new Promise((d,r)=>{var t;const e=document.createElement("script");p(e,{type:"text/javascript",src:s}),(t=document.querySelector("body"))==null||t.appendChild(e),e.onload=()=>{d(1)},e.onerror=n=>{r(n)}})}function C(s,d,r){var c;const e=(c=document.querySelector("head"))==null?void 0:c.innerHTML;document.querySelector("head")&&(document.querySelector("head").innerHTML=e+s);const t=/^(?:(http|https|ftp):\/\/)?((?:[\w-]+\.)+[a-z0-9]+)((?:\/[^/?#]*)+)?(\?[^#]+)?(#.+)?$/i,n=[];return d.filter(o=>o.address).map(o=>{t.test(o.address)&&n.push(S(o.address))}),r.filter(o=>o.address).map(o=>{t.test(o.address)&&n.push(_(o.address))}),Promise.all(n)}function l(s,d,r){const e=document.querySelector("#customHTML");e&&document.body.removeChild(e);const t=document.createElement("div");t.id="customHTML",t.innerHTML=s,document.body.appendChild(t);const n=document.querySelector("#customCSS");n&&document.head.removeChild(n);const c=document.createElement("style");c.id="customCSS",c.innerHTML=d,document.head.appendChild(c);const o=document.querySelector("#customJS");o&&document.body.removeChild(o);const i=document.createElement("script");i.id="customJS",i.innerHTML=`(function(){ 
    ${r.replace(/parent\.document/g,"__document__")}
  })()`,document.body.appendChild(i)}let m=!0;window.addEventListener("message",async s=>{var r;const{data:d}=s;try{const{type:e,data:t}=d;if(!t)return;const{html:n,css:c,javascript:o,setting:i}=t;if(e!=="editorChange")return;if(u(-1),c.code&&c.mode==="sass")try{const{css:a}=await y(c.code);c.code=a}catch(a){u(((r=a==null?void 0:a.error)==null?void 0:r.formatted)||"scss error")}if(m){const{headStuff:a,cssCDN:f,jsCDN:h}=i;C(a,f,h).finally(()=>{l(n.code,c.code,o.code)}),m=!1}else l(n.code,c.code,o.code)}catch(e){console.log(e)}},!1);
